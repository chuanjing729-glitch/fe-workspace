# 前端工程化工具链推广与落地指南

这份指南旨在帮助你向团队有效推广 `/packages` 下的工具库。推广新工具的核心在于**"解决现痛点"**而非**"引入新技术"**。

## 🎯 核心推广策略：ROI（投入产出比）驱动

不要直接说"这个工具很好"，要说"这个工具能帮我们省下 X 小时"或"能避免 Y 类线上故障"。

---

## 🛠 工具价值逐一击破

### 1. Webpack Spec Plugin (规范检查插件)
> **Slogan**: "构建阶段的自动代码审计官，把烂代码拦在上线前。"

*   **针对痛点**: 
    *   线上出现 `undefined` 报错（空指针）。
    *   代码风格不统一，CR (Code Review) 耗时在纠结变量命名。
    *   项目体积越来越大，图片未压缩直接上传。
*   **团队收益**:
    *   **安全性**: 自动拦截 30+ 种高危代码（XSS、eval、内存泄漏）。
    *   **效率**: 减少 50% 的 CR 时间，机器能干的不仅人干。
    *   **性能**: 强制图片/JS大小预算，防止首屏性能劣化。
*   **话术**: "上次那个线上 `xx is undefined` 的 bug，如果用这个插件，在本地 build 的时候就会直接报错阻断，根本不会发到线上。"

### 2. Incremental Coverage Plugin (增量覆盖率插件)
> **Slogan**: "只测你修改的代码，让单测从此跑得飞快。"

*   **针对痛点**:
    *   单测跑全量太慢，开发不愿意写/跑单测。
    *   改了一行代码，不知道覆盖到了没有，心理没底。
*   **团队收益**:
    *   **速度**: 不跑全量，只跑 Diff 部分，快 10 倍以上。
    *   **可视**: 浏览器右下角直接显示"当前修改代码覆盖率"，写一行测一行。
*   **话术**: "大家不是不想写单测，是跑起来太慢。这个工具只盯着你改的那几个文件测，浏览器里直接看绿灯，写代码像玩游戏一样有反馈。"

### 3. Webpack API Tracker Plugin (API 变更追踪)
> **Slogan**: "后端改接口没通知？构建工具第一时间告诉你。"

*   **针对痛点**:
    *   后端偷偷改了字段类型/删了字段，前端发布后才发现挂了。
    *   TypeScript 类型定义全是 `any`，没有跟后端契约对齐。
*   **团队收益**:
    *   **可靠性**: 每次构建自动比对 Swagger/YAPI，发现变更差异。
    *   **协作**: 倒逼前后端契约对齐。
*   **话术**: "后端改字段经常不吼一声，用这个插件，只要他们改了文档，我们本地启动就能收到警报，不用等到测试阶段才发现。"

### 4. Core Utils & Vue2 Toolkit (核心基础库)
> **Slogan**: "统一底层原子能力，拒绝重复造轮子。"

*   **针对痛点**:
    *   每个人都写一遍 `formatDate`，项目里有 5 种日期格式化写法。
    *   Vue 组件里 `addEventListener` 经常忘写 `removeEventListener`，导致内存泄漏。
*   **团队收益**:
    *   **质量**: 经过完备单测（100% 覆盖率）的稳健函数。
    *   **统一**: 统一处理兼容性（iOS/Android）、空值防护。
*   **话术**: "`Core Utils` 里的函数都是经过几百个 Case 测试过的，比我们随手写的更安全。特别是 `Vue2 Toolkit` 的自动清理 Mixin，直接解决掉组件销毁忘记清定时器的问题。"

### 5. 🛡️ 质量承诺：用数据说话 (Quality Assurance)

要说服团队使用工具，最硬的底气是**代码质量**。我们对所有工具库执行了严格的测试标准。

#### 📦 @51jbs/core-utils (纯 JS 工具库)

**整体覆盖率**: **92.08%** (Lines) | **186 个测试用例全部通过** ✅

| 模块 | Lines Coverage | 状态 | 说明 |
| :--- | :--- | :--- | :--- |
| **Array** | **100%** | ✅ 完美 | 分页、去重、分组、集合运算 |
| **Format** | **100%** | ✅ 完美 | 金额、日期、脱敏格式化 |
| **Event** | **100%** | ✅ 完美 | 事件总线、委托、生命周期管理 |
| **Object** | **98.33%** | 🚀 接近完美 | 深拷贝、合并、安全取值 |
| **Device** | **97.1%** | 🌿 优秀 | 设备检测、浏览器识别 |
| **Validation** | **94.04%** | 🌿 优秀 | 手机号、邮箱、身份证校验 |
| **URL** | **84.74%** | 🌿 良好 | URL 参数解析与构建 |
| **DOM** | **82.5%** | 🌿 良好 | DOM 操作、样式管理 |
| **HTTP** | **75%** | 🔶 持续改进 | HTTP 客户端、拦截器 |

#### 🎨 @51jbs/vue2-toolkit (Vue 2 工具库)

**整体覆盖率**: **65%+** (Lines) | **核心模块 > 90%**

> **✅ 质量里程碑**:
> - **RequestManager**: 100% 覆盖，确保请求自动取消，杜绝竞态。
> - **EventManager**: 88% 覆盖，杜绝事件监听内存泄漏。
> - **Directives**: 核心指令如 `v-permission`, `v-drag` 覆盖率 > 85%。
> - **Crash防护**: 修复了所有 Mixins 在销毁时的潜在崩溃问题。

---

> **我们的承诺**: 
> - **Core-Utils** 将持续向 **100% 覆盖率** 迈进
> - **所有测试用例** 在 CI/CD 中自动运行，确保每次提交的质量
> - 使用这些经过**数百个测试用例验证**的代码，远比 CV 大法（Copy-Paste）更可靠

---

## 📉 落地三步走（减少抵触情绪）

### 第一阶段：潜移默化（Pilot）
*   **动作**: 你自己在负责的模块中**静默接入**这些工具。
*   **目的**: 收集数据。
*   **展示**:
    *   "看，这个插件帮我发现了 3 个潜在 bug。"
    *   "我这个模块的图片自动压缩了，体积小了 30%。"

### 第二阶段：非强制推荐（Recommend）
*   **动作**: 在周会分享，提供**一键接入**脚本。
*   **策略**: 配置默认为 `warning` 级别（不阻断构建），让大家先尝鲜。
*   **重点**: 强调**无痛**。配置已经配好了，npm install 就能用。

### 第三阶段：基线准入（Enforce）
*   **动作**: 结合 Git Hooks 或 CI/CD。
*   **策略**: 对于**新代码**开启强校验（增量模式），不追究老代码（避免一上来报 1000 个错把人吓跑）。
*   **话术**: "我们只对新增代码有要求，老代码慢慢修。"

## 💬 常见质疑 & 回答 (FAQ)

**Q: 引入这么多插件，构建会不会变慢？**
> **A**: "大部分插件（如 Spec/Coverage）都支持**增量模式**和**缓存**。只有第一次慢，后面只检查修改过的文件，几乎无感。"

**Q: 现有的代码已经这么多 warning 了，修不完啊？**
> **A**: "我们开启**基线模式 (Baseline)**。现有的问题录入白名单，只拦截**新增**的问题。保证代码库是'越来越好'，而不是'必须完美'。"

**Q: 学习成本高吗？**
> **A**: "主要是一些配置。我已经封装好了 preset（预设配置），大家直接引用我的配置就行，开箱即用。"
