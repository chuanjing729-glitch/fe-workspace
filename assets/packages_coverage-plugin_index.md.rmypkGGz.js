import{_ as i,c as a,o as n,a3 as e}from"./chunks/framework.KoSEt7m1.js";const c=JSON.parse('{"title":"coverage-plugin","description":"","frontmatter":{"title":"coverage-plugin","order":1,"editLink":true},"headers":[],"relativePath":"packages/coverage-plugin/index.md","filePath":"packages/coverage-plugin/index.md"}'),t={name:"packages/coverage-plugin/index.md"};function l(h,s,p,k,r,d){return n(),a("div",null,[...s[0]||(s[0]=[e(`<h1 id="é€šç”¨å‰ç«¯è¦†ç›–ç‡æ’ä»¶-universal-coverage-plugin" tabindex="-1">é€šç”¨å‰ç«¯è¦†ç›–ç‡æ’ä»¶ (Universal Coverage Plugin) <a class="header-anchor" href="#é€šç”¨å‰ç«¯è¦†ç›–ç‡æ’ä»¶-universal-coverage-plugin" aria-label="Permalink to &quot;é€šç”¨å‰ç«¯è¦†ç›–ç‡æ’ä»¶ (Universal Coverage Plugin)&quot;">â€‹</a></h1><blockquote><p>ğŸš€ <strong>æ¶æ„å‡çº§</strong>: åŸºäº Unplugin çš„é€šç”¨æ¶æ„ï¼ŒåŒæ—¶æ”¯æŒ Webpack, Vite å’Œ Rspackã€‚</p></blockquote><p>æœ¬æ’ä»¶ç”¨äºåœ¨å¼€å‘é˜¶æ®µæ”¶é›†ä»£ç è¦†ç›–ç‡ï¼Œå¹¶ç”Ÿæˆå¢é‡è‡ªæµ‹æŠ¥å‘Šã€‚å³æ—¶åé¦ˆå˜æ›´å½±å“ï¼Œæå‡å‰ç«¯ç ”å‘è´¨é‡ã€‚</p><h2 id="âœ¨-æ ¸å¿ƒç‰¹æ€§" tabindex="-1">âœ¨ æ ¸å¿ƒç‰¹æ€§ <a class="header-anchor" href="#âœ¨-æ ¸å¿ƒç‰¹æ€§" aria-label="Permalink to &quot;âœ¨ æ ¸å¿ƒç‰¹æ€§&quot;">â€‹</a></h2><ul><li><strong>ğŸŒ å¤šæ„å»ºå·¥å…·æ”¯æŒ</strong>: ä¸€å¥—ä»£ç ï¼ŒåŒæ—¶æ”¯æŒ Webpack 4/5, Vite, Rspackã€‚</li><li><strong>ğŸ” å¢é‡è¦†ç›–ç‡</strong>: åŸºäº Git Diff å’Œè¿è¡Œæ—¶æ•°æ®ï¼Œç²¾å‡†è®¡ç®—å˜æ›´ä»£ç çš„è¦†ç›–ç‡ã€‚</li><li><strong>ğŸ“Š åˆ†å±‚æŠ¥å‘Š (Reporter 2.0)</strong>: <ul><li>å…¨æ–° Dashboard è§†å›¾</li><li>äº¤äº’å¼å›¾è¡¨ (Chart.js)</li><li>å½±å“é¢åˆ†æ (Impact Analysis)</li><li><strong>ğŸ’» ç¯å¢ƒä¿¡æ¯</strong>: é›†æˆ Git (åˆ†æ”¯/æäº¤äºº)ã€ç¡¬ä»¶ (CPU/å†…å­˜) åŠæµè§ˆå™¨ä¿¡æ¯</li></ul></li><li><strong>âš¡ï¸ é«˜æ€§èƒ½åˆ†æ</strong>: å†…ç½® AST ç¼“å­˜ (SHA-256)ï¼Œå¤§å¹…æå‡äºŒæ¬¡æ„å»ºé€Ÿåº¦ã€‚</li><li><strong>ğŸ§© å½±å“é¢è‡ªåŠ¨è¯†åˆ«</strong>: è‡ªåŠ¨åˆ†æä»£ç ä¾èµ–ï¼Œè¯†åˆ«å—å½±å“çš„é¡µé¢å’Œç»„ä»¶ã€‚</li><li><strong>ğŸ›  å¼€å‘è€…å‹å¥½</strong>: <ul><li>è¿è¡Œæ—¶æ‚¬æµ®æ°”æ³¡ (Overlay)</li><li>å¿«æ·é”®æ“ä½œ (Ctrl+Shift+C)</li></ul></li></ul><h2 id="ğŸ“š-æ–‡æ¡£" tabindex="-1">ğŸ“š æ–‡æ¡£ <a class="header-anchor" href="#ğŸ“š-æ–‡æ¡£" aria-label="Permalink to &quot;ğŸ“š æ–‡æ¡£&quot;">â€‹</a></h2><ul><li><a href="./TECHNICAL_DOC"><strong>æŠ€æœ¯æ¶æ„æ–‡æ¡£ (Architecture &amp; Design)</strong></a>: åŒ…å«æ¶æ„å›¾ã€æ—¶åºå›¾åŠæ ¸å¿ƒæµç¨‹è¯´æ˜ã€‚</li><li><a href="https://github.com/chuanjing729-glitch/fe-workspace/blob/main/packages/coverage-plugin/CHANGELOG.md" target="_blank" rel="noreferrer"><strong>å˜æ›´æ—¥å¿— (Changelog)</strong></a>: ç‰ˆæœ¬æ›´æ–°è®°å½•ã€‚</li></ul><h2 id="ğŸ“¦-å®‰è£…" tabindex="-1">ğŸ“¦ å®‰è£… <a class="header-anchor" href="#ğŸ“¦-å®‰è£…" aria-label="Permalink to &quot;ğŸ“¦ å®‰è£…&quot;">â€‹</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> @51jbs/coverage-plugin</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --save-dev</span></span></code></pre></div><h2 id="ğŸš€-å¿«é€Ÿå¼€å§‹" tabindex="-1">ğŸš€ å¿«é€Ÿå¼€å§‹ <a class="header-anchor" href="#ğŸš€-å¿«é€Ÿå¼€å§‹" aria-label="Permalink to &quot;ğŸš€ å¿«é€Ÿå¼€å§‹&quot;">â€‹</a></h2><h3 id="_1-æ¥å…¥é…ç½®" tabindex="-1">1. æ¥å…¥é…ç½® <a class="header-anchor" href="#_1-æ¥å…¥é…ç½®" aria-label="Permalink to &quot;1. æ¥å…¥é…ç½®&quot;">â€‹</a></h3><h4 id="webpack" tabindex="-1">Webpack <a class="header-anchor" href="#webpack" aria-label="Permalink to &quot;Webpack&quot;">â€‹</a></h4><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// webpack.config.js</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">WebpackCoveragePlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;@51jbs/coverage-plugin&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  plugins: [</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> WebpackCoveragePlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      enabled: process.env.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ENABLE_SELF_TEST</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;true&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      include: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;src/**/*.{js,ts,jsx,tsx,vue}&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><h4 id="vite" tabindex="-1">Vite <a class="header-anchor" href="#vite" aria-label="Permalink to &quot;Vite&quot;">â€‹</a></h4><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// vite.config.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { defineConfig } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vite&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> coverage </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@51jbs/coverage-plugin/vite&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  plugins: [</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    coverage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      enabled: process.env.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ENABLE_SELF_TEST</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;true&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      include: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;src/**/*.{js,ts,jsx,tsx,vue}&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><h4 id="rspack" tabindex="-1">Rspack <a class="header-anchor" href="#rspack" aria-label="Permalink to &quot;Rspack&quot;">â€‹</a></h4><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// rspack.config.js</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">rspackCoveragePlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;@51jbs/coverage-plugin/rspack&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  plugins: [</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    rspackCoveragePlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      enabled: process.env.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ENABLE_SELF_TEST</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;true&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      include: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;src/**/*.{js,ts,jsx,tsx,vue}&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><h3 id="_2-é…ç½®é€‰é¡¹-options" tabindex="-1">2. é…ç½®é€‰é¡¹ (Options) <a class="header-anchor" href="#_2-é…ç½®é€‰é¡¹-options" aria-label="Permalink to &quot;2. é…ç½®é€‰é¡¹ (Options)&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>é€‰é¡¹</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>enabled</code></td><td><code>boolean</code></td><td><code>false</code></td><td>æ˜¯å¦å¯ç”¨æ’ä»¶ã€‚å»ºè®®ä»…åœ¨å¼€å‘ç¯å¢ƒå¼€å¯ã€‚</td></tr><tr><td><code>include</code></td><td><code>string[]</code></td><td><code>[]</code></td><td>éœ€è¦æ’æ¡©çš„æ–‡ä»¶ glob æ¨¡å¼ã€‚</td></tr><tr><td><code>exclude</code></td><td><code>(string|RegExp)[]</code></td><td><code>[/node_modules/, /\\.test\\./]</code></td><td>æ’é™¤çš„æ–‡ä»¶æ¨¡å¼ã€‚</td></tr><tr><td><code>outputDir</code></td><td><code>string</code></td><td><code>.coverage</code></td><td>æŠ¥å‘Šè¾“å‡ºç›®å½•ã€‚</td></tr><tr><td><code>enableImpactAnalysis</code></td><td><code>boolean</code></td><td><code>true</code></td><td>æ˜¯å¦å¯ç”¨å½±å“é¢åˆ†æï¼ˆä¾èµ–åˆ†æï¼‰ã€‚</td></tr><tr><td><code>enableOverlay</code></td><td><code>boolean</code></td><td><code>true</code></td><td>æ˜¯å¦å¯ç”¨æµè§ˆå™¨ç«¯æ‚¬æµ®æ°”æ³¡ UIã€‚</td></tr></tbody></table><h3 id="_3-å¼€å‘æµç¨‹" tabindex="-1">3. å¼€å‘æµç¨‹ <a class="header-anchor" href="#_3-å¼€å‘æµç¨‹" aria-label="Permalink to &quot;3. å¼€å‘æµç¨‹&quot;">â€‹</a></h3><ol><li><p><strong>å¯åŠ¨å¼€å‘æœåŠ¡</strong>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ENABLE_SELF_TEST</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">true</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dev</span></span></code></pre></div></li><li><p><strong>è¿›è¡Œè‡ªæµ‹</strong>: åœ¨æµè§ˆå™¨ä¸­æ“ä½œé¡µé¢ï¼Œæ’ä»¶ä¼šè‡ªåŠ¨æ”¶é›†è¿è¡Œæ—¶è¦†ç›–ç‡ã€‚</p></li><li><p><strong>ç”ŸæˆæŠ¥å‘Š</strong>:</p><ul><li>ç‚¹å‡»é¡µé¢å³ä¸‹è§’çš„æ‚¬æµ®æ°”æ³¡</li><li>æˆ–æŒ‰å¿«æ·é”® <code>Ctrl+Shift+C</code></li></ul><p>æ’ä»¶å°†ç”Ÿæˆ <code>smart-test-report.html</code> å¹¶è‡ªåŠ¨è®¡ç®—å¢é‡è¦†ç›–ç‡ã€‚</p></li></ol><h2 id="âš™ï¸-æ¶æ„è®¾è®¡" tabindex="-1">âš™ï¸ æ¶æ„è®¾è®¡ <a class="header-anchor" href="#âš™ï¸-æ¶æ„è®¾è®¡" aria-label="Permalink to &quot;âš™ï¸ æ¶æ„è®¾è®¡&quot;">â€‹</a></h2><p>æœ¬æ’ä»¶é‡‡ç”¨ <strong>Universal Plugin Architecture</strong>ï¼š</p><ul><li><strong>Core</strong>: å¹³å°æ— å…³çš„æ ¸å¿ƒé€»è¾‘ (<code>CoveragePluginCore</code>)ã€‚</li><li><strong>Adapters</strong>: é€‚é…ä¸åŒæ„å»ºå·¥å…· (<code>Unplugin</code>, <code>ViteCoveragePlugin</code>, <code>WebpackCoveragePlugin</code>)ã€‚</li><li><strong>Infrastructure</strong>: HTTPæœåŠ¡, æ–‡ä»¶å­˜å‚¨, æŠ¥å‘Šæ¸²æŸ“.</li></ul><p>è¯¦æƒ…è¯·å‚é˜… <a href="./TECHNICAL_DOC">TECHNICAL_DOC.md</a>ã€‚</p><h2 id="ğŸ“-è´¡çŒ®" tabindex="-1">ğŸ“ è´¡çŒ® <a class="header-anchor" href="#ğŸ“-è´¡çŒ®" aria-label="Permalink to &quot;ğŸ“ è´¡çŒ®&quot;">â€‹</a></h2><p>æ¬¢è¿æäº¤ Issue å’Œ PRã€‚</p><h2 id="ğŸ“„-è®¸å¯è¯" tabindex="-1">ğŸ“„ è®¸å¯è¯ <a class="header-anchor" href="#ğŸ“„-è®¸å¯è¯" aria-label="Permalink to &quot;ğŸ“„ è®¸å¯è¯&quot;">â€‹</a></h2><p>MIT</p>`,29)])])}const g=i(t,[["render",l]]);export{c as __pageData,g as default};
