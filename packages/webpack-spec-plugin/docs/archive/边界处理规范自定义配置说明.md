# è¾¹ç•Œå¤„ç†è§„èŒƒ - è‡ªå®šä¹‰é…ç½®è¯´æ˜

> ç‰ˆæœ¬: 2.0  
> æ›´æ–°æ—¥æœŸ: 2025-12-15

---

## ğŸ“‹ é…ç½®æ¦‚è§ˆ

è¾¹ç•Œå¤„ç†è§„èŒƒæ¨¡å—æ”¯æŒçµæ´»çš„è‡ªå®šä¹‰é…ç½®ï¼Œå…è®¸æ‚¨æ ¹æ®é¡¹ç›®éœ€æ±‚é€‰æ‹©æ€§å¯ç”¨æ£€æŸ¥è§„åˆ™ï¼Œå¹¶è°ƒæ•´æ£€æŸ¥é˜ˆå€¼ã€‚

---

## ğŸ”§ åŸºæœ¬é…ç½®

### é»˜è®¤é…ç½®ï¼ˆå…¨éƒ¨å¯ç”¨ï¼‰

```javascript
const WebpackSpecPlugin = require('@51jbs/webpack-spec-plugin')

module.exports = {
  plugins: [
    new WebpackSpecPlugin({
      rules: {
        boundary: true  // å¯ç”¨è¾¹ç•Œå¤„ç†è§„èŒƒæ£€æŸ¥
      }
    })
  ]
}
```

æ‰€æœ‰è¾¹ç•Œæ£€æŸ¥è§„åˆ™é»˜è®¤å¯ç”¨ã€‚

---

## âš™ï¸ é«˜çº§é…ç½®

### 1. é€‰æ‹©æ€§å¯ç”¨æ£€æŸ¥é¡¹

é€šè¿‡ `boundaryConfig` é…ç½®ï¼Œå¯ä»¥ç²¾ç¡®æ§åˆ¶æ¯ä¸ªæ£€æŸ¥é¡¹çš„å¯ç”¨çŠ¶æ€ï¼š

```javascript
new WebpackSpecPlugin({
  rules: {
    boundary: true
  },
  boundaryConfig: {
    // é™¤é›¶é”™è¯¯æ£€æŸ¥ï¼ˆé»˜è®¤: trueï¼‰
    checkDivisionZero: true,
    
    // æ•°ç»„è¶Šç•Œæ£€æŸ¥ï¼ˆé»˜è®¤: trueï¼‰
    checkArrayBounds: true,
    
    // å¯¹è±¡å±æ€§è®¿é—®æ£€æŸ¥ï¼ˆé»˜è®¤: trueï¼‰
    checkObjectAccess: true,
    
    // JSON.parse æ£€æŸ¥ï¼ˆé»˜è®¤: trueï¼‰
    checkJsonParse: true,
    
    // å¾ªç¯è¾¹ç•Œæ£€æŸ¥ï¼ˆé»˜è®¤: trueï¼‰
    checkLoopBounds: true,
    
    // é€’å½’ç»ˆæ­¢æ¡ä»¶æ£€æŸ¥ï¼ˆé»˜è®¤: trueï¼‰
    checkRecursion: true
  }
})
```

### 2. è°ƒæ•´æ£€æŸ¥é˜ˆå€¼

æŸäº›æ£€æŸ¥è§„åˆ™æ”¯æŒè‡ªå®šä¹‰é˜ˆå€¼ï¼š

```javascript
new WebpackSpecPlugin({
  rules: {
    boundary: true
  },
  boundaryConfig: {
    // å¤§ç´¢å¼•è®¿é—®æ£€æŸ¥é˜ˆå€¼ï¼ˆé»˜è®¤: 10ï¼‰
    // å½“æ•°ç»„ç´¢å¼• > è¯¥å€¼æ—¶ï¼Œå»ºè®®æ£€æŸ¥æ•°ç»„é•¿åº¦
    largeIndexThreshold: 20,
    
    // æœ€å¤§åˆ†é¡µå¤§å°ï¼ˆé»˜è®¤: 100ï¼‰
    // pageSize è¶…è¿‡è¯¥å€¼æ—¶ä¼šæŠ¥è­¦å‘Š
    maxPageSize: 200
  }
})
```

---

## ğŸ“ é…ç½®é¡¹è¯¦è§£

### `checkDivisionZero`
- **ç±»å‹**: `boolean`
- **é»˜è®¤å€¼**: `true`
- **è¯´æ˜**: æ£€æŸ¥é™¤æ³•è¿ç®—å‰æ˜¯å¦éªŒè¯é™¤æ•°ä¸ºé›¶
- **æ£€æŸ¥è§„åˆ™**: `boundary/division-zero`
- **ç¤ºä¾‹**:
  ```javascript
  // âŒ ä¼šæŠ¥é”™
  const result = a / b
  
  // âœ… é€šè¿‡æ£€æŸ¥
  const result = b !== 0 ? a / b : 0
  ```

### `checkArrayBounds`
- **ç±»å‹**: `boolean`
- **é»˜è®¤å€¼**: `true`
- **è¯´æ˜**: æ£€æŸ¥æ•°ç»„æ“ä½œæ˜¯å¦è¿›è¡Œè¾¹ç•Œæ£€æŸ¥
- **æ£€æŸ¥è§„åˆ™**: 
  - `boundary/array-slice`
  - `boundary/array-splice`
  - `boundary/string-index`
  - `boundary/large-index`
- **ç¤ºä¾‹**:
  ```javascript
  // âŒ ä¼šæŠ¥è­¦å‘Š
  const top10 = users.slice(0, 10)
  
  // âœ… é€šè¿‡æ£€æŸ¥
  const top10 = Array.isArray(users) ? users.slice(0, 10) : []
  ```

### `checkObjectAccess`
- **ç±»å‹**: `boolean`
- **é»˜è®¤å€¼**: `true`
- **è¯´æ˜**: æ£€æŸ¥å¯¹è±¡å±æ€§è®¿é—®æ˜¯å¦å®‰å…¨
- **æ£€æŸ¥è§„åˆ™**: 
  - `boundary/object-property-access`
  - `boundary/object-key-access`
- **ç¤ºä¾‹**:
  ```javascript
  // âŒ ä¼šæŠ¥è­¦å‘Š
  const name = user.profile.name
  const value = obj[key]
  
  // âœ… é€šè¿‡æ£€æŸ¥
  const name = user?.profile?.name
  if (key in obj) {
    const value = obj[key]
  }
  ```

### `checkJsonParse`
- **ç±»å‹**: `boolean`
- **é»˜è®¤å€¼**: `true`
- **è¯´æ˜**: æ£€æŸ¥ JSON.parse æ˜¯å¦ä½¿ç”¨ try-catch åŒ…è£¹
- **æ£€æŸ¥è§„åˆ™**: `boundary/json-parse`
- **ç¤ºä¾‹**:
  ```javascript
  // âŒ ä¼šæŠ¥é”™
  const data = JSON.parse(jsonString)
  
  // âœ… é€šè¿‡æ£€æŸ¥
  try {
    const data = JSON.parse(jsonString)
  } catch (error) {
    console.error('JSON è§£æå¤±è´¥', error)
  }
  ```

### `checkLoopBounds`
- **ç±»å‹**: `boolean`
- **é»˜è®¤å€¼**: `true`
- **è¯´æ˜**: æ£€æŸ¥å¾ªç¯è¾¹ç•Œæ¡ä»¶
- **æ£€æŸ¥è§„åˆ™**: 
  - `boundary/loop-off-by-one`
  - `boundary/infinite-loop`
  - `boundary/while-no-exit`
- **ç¤ºä¾‹**:
  ```javascript
  // âŒ ä¼šæŠ¥é”™
  for (let i = 0; i <= arr.length; i++) {
    console.log(arr[i])
  }
  
  // âœ… é€šè¿‡æ£€æŸ¥
  for (let i = 0; i < arr.length; i++) {
    console.log(arr[i])
  }
  ```

### `checkRecursion`
- **ç±»å‹**: `boolean`
- **é»˜è®¤å€¼**: `true`
- **è¯´æ˜**: æ£€æŸ¥é€’å½’å‡½æ•°æ˜¯å¦æœ‰ç»ˆæ­¢æ¡ä»¶
- **æ£€æŸ¥è§„åˆ™**: `boundary/recursion-no-base`
- **ç¤ºä¾‹**:
  ```javascript
  // âŒ ä¼šæŠ¥é”™
  function factorial(n) {
    return n * factorial(n - 1)
  }
  
  // âœ… é€šè¿‡æ£€æŸ¥
  function factorial(n) {
    if (n <= 1) return 1
    return n * factorial(n - 1)
  }
  ```

### `largeIndexThreshold`
- **ç±»å‹**: `number`
- **é»˜è®¤å€¼**: `10`
- **è¯´æ˜**: å¤§ç´¢å¼•è®¿é—®çš„é˜ˆå€¼ï¼Œè¶…è¿‡æ­¤å€¼å»ºè®®æ£€æŸ¥æ•°ç»„é•¿åº¦
- **æ£€æŸ¥è§„åˆ™**: `boundary/large-index`
- **ç¤ºä¾‹**:
  ```javascript
  // å‡è®¾é˜ˆå€¼ä¸º 10
  
  // âŒ ä¼šæŠ¥è­¦å‘Š (index > 10)
  const item = arr[15]
  
  // âœ… ä¸æŠ¥è­¦å‘Š (index <= 10)
  const item = arr[5]
  ```

### `maxPageSize`
- **ç±»å‹**: `number`
- **é»˜è®¤å€¼**: `100`
- **è¯´æ˜**: æœ€å¤§åˆ†é¡µå¤§å°é™åˆ¶
- **æ£€æŸ¥è§„åˆ™**: `boundary/pagesize-max`
- **ç¤ºä¾‹**:
  ```javascript
  // å‡è®¾é˜ˆå€¼ä¸º 100
  
  // âŒ ä¼šæŠ¥è­¦å‘Š
  const params = { pageSize: 200 }
  
  // âœ… é€šè¿‡æ£€æŸ¥
  const MAX_PAGE_SIZE = 100
  const params = { pageSize: Math.min(userInput, MAX_PAGE_SIZE) }
  ```

---

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### åœºæ™¯1ï¼šä¸¥æ ¼æ¨¡å¼ï¼ˆæ¨èï¼‰

é€‚ç”¨äºæ–°é¡¹ç›®æˆ–é‡è§†ä»£ç è´¨é‡çš„é¡¹ç›®ï¼š

```javascript
new WebpackSpecPlugin({
  rules: {
    boundary: true
  },
  // ä½¿ç”¨é»˜è®¤é…ç½®ï¼Œå…¨éƒ¨å¯ç”¨
})
```

### åœºæ™¯2ï¼šæ¸è¿›å¼æ”¹é€ 

é€‚ç”¨äºå­˜é‡ä»£ç è¾ƒå¤šçš„è€é¡¹ç›®ï¼Œé€æ­¥å¯ç”¨æ£€æŸ¥ï¼š

```javascript
new WebpackSpecPlugin({
  rules: {
    boundary: true
  },
  boundaryConfig: {
    // ç¬¬ä¸€é˜¶æ®µï¼šåªå¯ç”¨å…³é”®æ£€æŸ¥
    checkDivisionZero: true,
    checkJsonParse: true,
    checkLoopBounds: true,
    checkRecursion: true,
    
    // æš‚æ—¶å…³é—­è­¦å‘Šè¾ƒå¤šçš„æ£€æŸ¥
    checkArrayBounds: false,
    checkObjectAccess: false
  }
})
```

### åœºæ™¯3ï¼šå®½æ¾æ¨¡å¼

é€‚ç”¨äºæ€§èƒ½æ•æ„Ÿæˆ–å¯¹è¯¯æŠ¥å®¹å¿åº¦ä½çš„é¡¹ç›®ï¼š

```javascript
new WebpackSpecPlugin({
  rules: {
    boundary: true
  },
  boundaryConfig: {
    // åªå¯ç”¨é”™è¯¯çº§åˆ«çš„æ£€æŸ¥
    checkDivisionZero: true,
    checkJsonParse: true,
    checkLoopBounds: true,
    checkRecursion: true,
    
    // å…³é—­è­¦å‘Šçº§åˆ«çš„æ£€æŸ¥
    checkArrayBounds: false,
    checkObjectAccess: false,
    
    // æé«˜é˜ˆå€¼ï¼Œå‡å°‘æŠ¥è­¦
    largeIndexThreshold: 50,
    maxPageSize: 500
  }
})
```

### åœºæ™¯4ï¼šè‡ªå®šä¹‰é˜ˆå€¼

æ ¹æ®é¡¹ç›®å®é™…æƒ…å†µè°ƒæ•´ï¼š

```javascript
new WebpackSpecPlugin({
  rules: {
    boundary: true
  },
  boundaryConfig: {
    // æ•°æ®é‡å¤§çš„é¡¹ç›®ï¼Œå…è®¸æ›´å¤§çš„åˆ†é¡µ
    maxPageSize: 200,
    
    // é•¿æ•°ç»„è¾ƒå¤šï¼Œæé«˜ç´¢å¼•é˜ˆå€¼
    largeIndexThreshold: 30
  }
})
```

---

## ğŸ“Š é…ç½®å¯¹æ¯”

| é…ç½®æ¨¡å¼ | checkDivision | checkArray | checkObject | checkJson | largeIndex | maxPageSize | é€‚ç”¨åœºæ™¯ |
|---------|--------------|------------|-------------|-----------|-----------|-------------|---------|
| ä¸¥æ ¼æ¨¡å¼ | âœ“ | âœ“ | âœ“ | âœ“ | 10 | 100 | æ–°é¡¹ç›® |
| æ¸è¿›æ¨¡å¼ | âœ“ | âœ— | âœ— | âœ“ | 10 | 100 | è€é¡¹ç›®æ”¹é€  |
| å®½æ¾æ¨¡å¼ | âœ“ | âœ— | âœ— | âœ“ | 50 | 500 | æ€§èƒ½æ•æ„Ÿé¡¹ç›® |
| è‡ªå®šä¹‰ | å¯é€‰ | å¯é€‰ | å¯é€‰ | å¯é€‰ | è‡ªå®šä¹‰ | è‡ªå®šä¹‰ | ç‰¹æ®Šéœ€æ±‚ |

---

## ğŸ” æ£€æŸ¥è§„åˆ™ç»Ÿè®¡

### æŒ‰æ£€æŸ¥é¡¹åˆ†ç±»

| æ£€æŸ¥é¡¹ | è§„åˆ™æ•°é‡ | ä¸¥é‡ç¨‹åº¦ |
|--------|---------|---------|
| checkDivisionZero | 2 | é”™è¯¯ + è­¦å‘Š |
| checkArrayBounds | 4 | è­¦å‘Š |
| checkObjectAccess | 2 | è­¦å‘Š |
| checkJsonParse | 1 | é”™è¯¯ |
| checkLoopBounds | 3 | é”™è¯¯ + è­¦å‘Š |
| checkRecursion | 1 | é”™è¯¯ |

### å…¨éƒ¨è§„åˆ™åˆ—è¡¨

1. **é™¤é›¶æ£€æŸ¥**
   - `boundary/division-zero` (é”™è¯¯)
   - `boundary/parse-nan` (è­¦å‘Š)

2. **æ•°ç»„è¾¹ç•Œ**
   - `boundary/array-slice` (è­¦å‘Š)
   - `boundary/array-splice` (è­¦å‘Š)
   - `boundary/string-index` (è­¦å‘Š)
   - `boundary/large-index` (è­¦å‘Š)

3. **å¯¹è±¡è®¿é—®**
   - `boundary/object-property-access` (è­¦å‘Š)
   - `boundary/object-key-access` (è­¦å‘Š)

4. **JSON è§£æ**
   - `boundary/json-parse` (é”™è¯¯)

5. **å¾ªç¯è¾¹ç•Œ**
   - `boundary/loop-off-by-one` (é”™è¯¯)
   - `boundary/infinite-loop` (é”™è¯¯)
   - `boundary/while-no-exit` (è­¦å‘Š)

6. **é€’å½’æ§åˆ¶**
   - `boundary/recursion-no-base` (é”™è¯¯)

7. **åˆ†é¡µå‚æ•°**
   - `boundary/pagination-max` (è­¦å‘Š)
   - `boundary/pagesize-max` (è­¦å‘Š)

8. **è¾“å…¥éªŒè¯**
   - `boundary/input-validation` (è­¦å‘Š)

9. **æ—¥æœŸæ£€æŸ¥**
   - `boundary/date-invalid` (è­¦å‘Š)

**æ€»è®¡**: 17 é¡¹æ£€æŸ¥è§„åˆ™

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. é€æ­¥å¯ç”¨

å¯¹äºè€é¡¹ç›®ï¼Œå»ºè®®é‡‡ç”¨é€æ­¥å¯ç”¨çš„ç­–ç•¥ï¼š

```javascript
// ç¬¬ä¸€å‘¨ï¼šå¯ç”¨é”™è¯¯çº§åˆ«æ£€æŸ¥
const week1Config = {
  checkDivisionZero: true,
  checkJsonParse: true,
  checkLoopBounds: true,
  checkRecursion: true
}

// ç¬¬äºŒå‘¨ï¼šä¿®å¤é”™è¯¯åï¼Œå¯ç”¨è­¦å‘Šçº§åˆ«æ£€æŸ¥
const week2Config = {
  ...week1Config,
  checkArrayBounds: true
}

// ç¬¬ä¸‰å‘¨ï¼šå…¨éƒ¨å¯ç”¨
const week3Config = {
  ...week2Config,
  checkObjectAccess: true
}
```

### 2. é…åˆ CI/CD

åœ¨ CI/CD æµç¨‹ä¸­ä½¿ç”¨ä¸åŒé…ç½®ï¼š

```javascript
const isProd = process.env.NODE_ENV === 'production'

new WebpackSpecPlugin({
  rules: {
    boundary: true
  },
  boundaryConfig: isProd ? {
    // ç”Ÿäº§ç¯å¢ƒï¼šä¸¥æ ¼æ¨¡å¼
    checkDivisionZero: true,
    checkArrayBounds: true,
    checkObjectAccess: true,
    checkJsonParse: true
  } : {
    // å¼€å‘ç¯å¢ƒï¼šåªæ£€æŸ¥å…³é”®é—®é¢˜
    checkDivisionZero: true,
    checkJsonParse: true
  }
})
```

### 3. å›¢é˜Ÿåå•†é˜ˆå€¼

æ ¹æ®å›¢é˜Ÿå®é™…æƒ…å†µåå•†åˆç†çš„é˜ˆå€¼ï¼š

```javascript
// å›¢é˜Ÿçº¦å®š
const TEAM_CONFIG = {
  // æ•°æ®é‡å¤§çš„åå°ç³»ç»Ÿï¼Œå…è®¸æ›´å¤§åˆ†é¡µ
  maxPageSize: 200,
  
  // æ•°ç»„æ“ä½œé¢‘ç¹ï¼Œæ”¾å®½ç´¢å¼•é˜ˆå€¼
  largeIndexThreshold: 20
}

new WebpackSpecPlugin({
  rules: { boundary: true },
  boundaryConfig: TEAM_CONFIG
})
```

---

## ğŸš€ å‡çº§æŒ‡å—

### ä» v1.0 å‡çº§åˆ° v2.0

v2.0 æ–°å¢äº†ä»¥ä¸‹ç‰¹æ€§ï¼š

1. **æ–°å¢æ£€æŸ¥è§„åˆ™**
   - âœ¨ `boundary/object-property-access` - å¯¹è±¡å±æ€§è®¿é—®æ£€æŸ¥
   - âœ¨ `boundary/object-key-access` - åŠ¨æ€é”®è®¿é—®æ£€æŸ¥
   - âœ¨ `boundary/json-parse` - JSON è§£æå®‰å…¨æ£€æŸ¥

2. **æ–°å¢é…ç½®é¡¹**
   - âœ¨ `boundaryConfig` - è‡ªå®šä¹‰é…ç½®æ”¯æŒ
   - âœ¨ å¯é€‰æ‹©æ€§å¯ç”¨æ£€æŸ¥é¡¹
   - âœ¨ å¯è°ƒæ•´æ£€æŸ¥é˜ˆå€¼

3. **ä¼˜åŒ–æ”¹è¿›**
   - ğŸ”§ æ”¹è¿›æ­£åˆ™è¡¨è¾¾å¼ï¼Œå‡å°‘è¯¯æŠ¥
   - ğŸ”§ ç§»é™¤æ³¨é‡Šå’Œå­—ç¬¦ä¸²ä¸­çš„æ£€æŸ¥
   - ğŸ”§ æ›´æ™ºèƒ½çš„ä¸Šä¸‹æ–‡åˆ†æ

### å…¼å®¹æ€§è¯´æ˜

v2.0 å®Œå…¨å‘ä¸‹å…¼å®¹ v1.0ï¼Œæ— éœ€ä¿®æ”¹ç°æœ‰é…ç½®ã€‚

å¦‚æœæœªè®¾ç½® `boundaryConfig`ï¼Œå°†ä½¿ç”¨é»˜è®¤é…ç½®ï¼ˆå…¨éƒ¨å¯ç”¨ï¼‰ã€‚

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [è¾¹ç•Œå¤„ç†è§„èŒƒè¯¦ç»†æ–‡æ¡£](../docs/specs/coding/boundary-specification.md)
- [è¾¹ç•Œå¤„ç†è§„èŒƒéªŒè¯æŠ¥å‘Š](./è¾¹ç•Œå¤„ç†è§„èŒƒéªŒè¯æŠ¥å‘Š.md)
- [æµ‹è¯•éªŒè¯æ€»ç»“](./æµ‹è¯•éªŒè¯æ€»ç»“.md)
- [è¾¹ç•Œå¤„ç†è§„èŒƒæµ‹è¯•è¯´æ˜](./è¾¹ç•Œå¤„ç†è§„èŒƒæµ‹è¯•è¯´æ˜.md)

---

**æ–‡æ¡£ç‰ˆæœ¬**: 2.0  
**æ›´æ–°æ—¥æœŸ**: 2025-12-15  
**ä½œè€…**: Chuanjing Li
